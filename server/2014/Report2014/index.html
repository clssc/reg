<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
<style>
  body {
    width: 800px;
    font-family: Open Sans, Arial, sans-serif;
    font-size: 16px;
  }
  p {
    padding: 0px 0px 0px 10px;
    color: green;
  }
  input {
    margin: 0px 0px 0px 10px;
    padding: 2px 2px 2px 2px;
    font-family: Open Sans, Arial, sans-serif;
    font-size: 16px;
  }
</style>

<h2>Rosters 2014</h2>

<h3>Full Roster</h3>
<p>Full class roster for Academic VP that contains key information for all students.</p>
<form>
  <input type="button" id="fullRoster" value="Generate Full Roster" />
</form>

<h3>Public Roster</h3>
<p>Public rosters are used during the beginning of school year. They contain information regarding which student is assigned to
what class, and where that class is.</p>
<form>
  <input type="button" id="publicRoster" value="Generate Public Roster" />
</form>

<h3>Class Roster</h3>
<p>Regenerate class rosters for teachers. Class roster contains contacts information for all students in a class. This can take
<strong>VERY LONG</strong>.</p>
<form>
  <input type="button" id="classRoster" value="Generate Class Roster" />
</form>
<p>The system is able to send out the class rosters in PDF form to the teachers. Each teacher will only get the contacts of
their class. Sorry, no TA&#39;s. The system has a limit of 500 e-mails per day so use this button with caution.</p>
<form>
  <input type="button" id="mailClassRoster" value="Mail Class Roster" />
</form>

<h2>Registration Form 2014</h2>

<h3>Blank Reg Form</h3>
<p>Generate blank registration form for hand writing.</p>
<form>
  <input type="button" id="blankRegForm" value="Generate Blank Form" />
</form>

<h3>Regenerate Single Reg Form</h3>
<p>Regenerate registration form for a single family, please input full name or family number below:</p>
<form>
  <input type="text" id="formIdentity" />
  <input type="button" id="singleRegForm" value="Generate Reg Form" />
</form>

<h3>Generate Reg Forms for a Class</h3>
<p>Generate registration forms of students of a class (in 2013). Please input class name below:</p>
<form>
  <input type="text" id="classIdentity" />
  <input type="button" id="allRegForm" value="Generate Reg Forms for Class" />
</form>

<div id="progress" title="Generating Report ...">
  <p>Server is generating reports, please wait patiently.</p>
</div>

<div id="completed" title="Report Generated">
  <p>Report generated: 
  <a id="reportLink" target="_blank">click here to see</a></p>
</div>

<div id="error" title="Error">
  <p>Report generation error:</p>
  <p id="errContext"></p>
</div>

<script>
  $(function() {
    $('#progress').dialog({
      autoOpen: false,
      resizable: false,
      modal: true,
    });
    $('#completed').dialog({
      autoOpen: false,
      resizable: false,
      modal: true,
      buttons: {
        'OK': function() { $(this).dialog('close'); }
      }
    });
    $('#error').dialog({
      autoOpen: false,
      resizable: false,
      modal: true,
      buttons: {
        'OK': function() { $(this).dialog('close'); }
      }
    });
        
    function commonStart() {
      $('#completed').dialog('close');
      $('#error').dialog('close');
      $('#progress').dialog('open');
    }
        
    $('#fullRoster').click(function() {
      commonStart();
      google.script.run.withSuccessHandler(defaultHandler).genFullRoster();
    });
        
    $('#publicRoster').click(function() {
      commonStart();
      google.script.run.withSuccessHandler(defaultHandler).genPublicRosters();
    });
        
    $('#classRoster').click(function() {
      commonStart();
      google.script.run.withSuccessHandler(defaultHandler).genClassRosters();
    });
        
    $('#mailClassRoster').click(function() {
      commonStart();
      google.script.run.withSuccessHandler(defaultHandler).mailClassRosters();
    });
        
    $('#blankRegForm').click(function() {
      commonStart();
      google.script.run.withSuccessHandler(defaultHandler).genBlankRegForm();
    });
        
    $('#singleRegForm').click(function() {
      commonStart();
      google.script.run.withSuccessHandler(defaultHandler).genRegForm($('#formIdentity').val());
    });
        
    $('#allRegForm').click(function() {
      commonStart();
      google.script.run.withSuccessHandler(defaultHandler).genRegFormsByClass($('#classIdentity').val());
    });
        
    function defaultHandler(link) {
      $('#progress').dialog('close');
      if (link.substring(0, 4) != 'http') {
        $('#errContext').text(link);
        $('#error').dialog('open');
      } else {
        $('a#reportLink').attr('href', link ? link : 'https://drive.google.com/a/westsidechineseschool.org/#folders/0BwvYC6nj697MZGNHY25qVEdlMHM');
        $('#completed').dialog('open');
      }
    }
  });
</script>